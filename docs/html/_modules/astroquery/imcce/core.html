<!DOCTYPE html>

<html lang="en" data-content_root="../../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>astroquery.imcce.core &#8212; astroquery v0.4.8.dev10177</title>
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../../_static/bootstrap-astropy.css?v=9d21690f" />
    <link rel="stylesheet" type="text/css" href="../../../_static/graphviz.css?v=fd3f3429" />
    <link rel="stylesheet" type="text/css" href="../../../_static/plot_directive.css" />
    
    <script src="../../../_static/jquery.js?v=5d32c60e"></script>
    <script src="../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
    <script src="../../../_static/documentation_options.js?v=51006566"></script>
    <script src="../../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script type="text/javascript" src="../../../_static/sidebar.js"></script>
    <script type="text/javascript" src="../../../_static/copybutton.js"></script>
    <link rel="icon" href="../../../_static/astropy_logo.ico"/>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:200,600' rel='stylesheet' type='text/css'/>

  </head><body>
<div class="topbar">
  <a class="brand" title="Documentation Home" href="../../../index.html"><span id="logotext1">astro</span><span id="logotext2">query</span><span id="logotext3">:docs</span></a>
  <ul>
    
    <li><a class="homelink" title="Astropy Homepage" href="http://www.astropy.org"></a></li>
    <li><a title="General Index" href="../../../genindex.html">Index</a></li>
    <li><a title="Module Index" href="../../../py-modindex.html">Modules</a></li>
    <li>
      
      
<form action="../../../search.html" method="get">
  <input type="text" name="q" placeholder="Search" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
      
    </li>
  </ul>
</div>

<div class="related">
    <h3>Navigation</h3>
    <ul>
      <li>
	<a href="../../../index.html">astroquery v0.4.8.dev10177</a>
	 &#187;
      </li>
      <li><a href="../../index.html" >Module code</a> &#187;</li>
      <li><a href="../imcce.html" accesskey="U">astroquery.imcce</a> &#187;</li>
      
       
    </ul>
</div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for astroquery.imcce.core</h1><div class="highlight"><pre>
<span></span><span class="c1"># Licensed under a 3-clause BSD style license - see LICENSE.rst</span>


<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">OrderedDict</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="kn">from</span> <span class="nn">io</span> <span class="kn">import</span> <span class="n">BytesIO</span>

<span class="kn">from</span> <span class="nn">astropy.table</span> <span class="kn">import</span> <span class="n">QTable</span><span class="p">,</span> <span class="n">MaskedColumn</span>
<span class="kn">from</span> <span class="nn">astropy.io</span> <span class="kn">import</span> <span class="n">ascii</span>
<span class="kn">from</span> <span class="nn">astropy.time</span> <span class="kn">import</span> <span class="n">Time</span>
<span class="kn">from</span> <span class="nn">astropy.io.votable</span> <span class="kn">import</span> <span class="n">parse</span>
<span class="kn">import</span> <span class="nn">astropy.units</span> <span class="k">as</span> <span class="nn">u</span>
<span class="kn">from</span> <span class="nn">astropy.coordinates</span> <span class="kn">import</span> <span class="n">SkyCoord</span><span class="p">,</span> <span class="n">Angle</span>

<span class="kn">from</span> <span class="nn">..query</span> <span class="kn">import</span> <span class="n">BaseQuery</span>
<span class="kn">from</span> <span class="nn">..utils</span> <span class="kn">import</span> <span class="n">async_to_sync</span><span class="p">,</span> <span class="n">commons</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">conf</span>

<span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Miriade&#39;</span><span class="p">,</span> <span class="s1">&#39;MiriadeClass&#39;</span><span class="p">,</span> <span class="s1">&#39;Skybot&#39;</span><span class="p">,</span> <span class="s1">&#39;SkybotClass&#39;</span><span class="p">]</span>


<div class="viewcode-block" id="MiriadeClass">
<a class="viewcode-back" href="../../../api/astroquery.imcce.MiriadeClass.html#astroquery.imcce.MiriadeClass">[docs]</a>
<span class="nd">@async_to_sync</span>
<span class="k">class</span> <span class="nc">MiriadeClass</span><span class="p">(</span><span class="n">BaseQuery</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A class for querying the</span>
<span class="sd">    `IMCCE/Miriade &lt;http://vo.imcce.fr/webservices/miriade/&gt;`_ service.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">_query_uri</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># uri used in query</span>
    <span class="n">_get_raw_response</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">uri</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        URI used in query to service.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_query_uri</span>

<div class="viewcode-block" id="MiriadeClass.get_ephemerides_async">
<a class="viewcode-back" href="../../../api/astroquery.imcce.MiriadeClass.html#astroquery.imcce.MiriadeClass.get_ephemerides_async">[docs]</a>
    <span class="k">def</span> <span class="nf">get_ephemerides_async</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">targetname</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">objtype</span><span class="o">=</span><span class="s1">&#39;asteroid&#39;</span><span class="p">,</span>
                              <span class="n">epoch</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">epoch_step</span><span class="o">=</span><span class="s1">&#39;1d&#39;</span><span class="p">,</span> <span class="n">epoch_nsteps</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                              <span class="n">location</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">coordtype</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                              <span class="n">timescale</span><span class="o">=</span><span class="s1">&#39;UTC&#39;</span><span class="p">,</span>
                              <span class="n">planetary_theory</span><span class="o">=</span><span class="s1">&#39;INPOP&#39;</span><span class="p">,</span>
                              <span class="n">ephtype</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                              <span class="n">refplane</span><span class="o">=</span><span class="s1">&#39;equator&#39;</span><span class="p">,</span>
                              <span class="n">elements</span><span class="o">=</span><span class="s1">&#39;ASTORB&#39;</span><span class="p">,</span>
                              <span class="n">radial_velocity</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                              <span class="n">get_query_payload</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                              <span class="n">get_raw_response</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">cache</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Query the</span>
<span class="sd">        `IMCCE Miriade &lt;http://vo.imcce.fr/webservices/miriade/&gt;`_</span>
<span class="sd">        `ephemcc &lt;http://vo.imcce.fr/webservices/miriade/?ephemcc&gt;`_</span>
<span class="sd">        service.</span>


<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>

<span class="sd">        targetname : str</span>
<span class="sd">            Name of the target to be queried.</span>

<span class="sd">        objtype : str, optional</span>
<span class="sd">            Type of the object to be queried. Available are: ``&#39;asteroid&#39;``,</span>
<span class="sd">            ``&#39;comet&#39;``, ``&#39;dwarf planet&#39;``, ``&#39;planet&#39;``, ``&#39;satellite&#39;``.</span>
<span class="sd">            Default: ``&#39;asteroid&#39;``</span>

<span class="sd">        epoch : `~astropy.time.Time` object, float, str,``None``, optional</span>
<span class="sd">            Start epoch of the query. If a float is provided, it is</span>
<span class="sd">            expected to be a Julian Date; if a str is provided, it is</span>
<span class="sd">            expected to be an iso date of the form</span>
<span class="sd">            ``&#39;YYYY-MM-DD HH-MM-SS&#39;``. If ``None`` is provided, the</span>
<span class="sd">            current date and time are used as epoch. Default: ``None``</span>

<span class="sd">        epoch_step : str, optional</span>
<span class="sd">            Step size for ephemerides calculation. Must consist of a decimal</span>
<span class="sd">            number followed by a single character: (d)ays, (h)ours,</span>
<span class="sd">            (m)inutes or (s)econds. Default: ``&#39;1d&#39;``</span>

<span class="sd">        epoch_nsteps : int, optional</span>
<span class="sd">            Number of increments of ``epoch_step`` starting from ``epoch``</span>
<span class="sd">            for which ephemerides are calculated. Maximum number of steps</span>
<span class="sd">            is 5000. Default: 1</span>

<span class="sd">        location : str, optional</span>
<span class="sd">            Location of the observer on Earth as a code or a set of</span>
<span class="sd">            coordinates. See the</span>
<span class="sd">            `Miriade manual &lt;http://vo.imcce.fr/webservices/miriade/?documentation#field_7&gt;`_</span>
<span class="sd">            for details. Default: geocentric location (``&#39;500&#39;``)</span>

<span class="sd">        coordtype : int, optional</span>
<span class="sd">            Type of coordinates to be calculated: ``1``: spherical, ``2``:</span>
<span class="sd">            rectangular, ``3``: local coordinates (azimuth and elevation),</span>
<span class="sd">            ``4``: hour angle coordinates, ``5``: dedicated to observation,</span>
<span class="sd">            ``6``: dedicated to AO observation. Default: ``1``</span>

<span class="sd">        timescale : str, optional</span>
<span class="sd">            The time scale used in the computation of the ephemerides:</span>
<span class="sd">            ``&#39;UTC&#39;`` or ``&#39;TT&#39;``. Default: ``&#39;UTC&#39;``</span>

<span class="sd">        planetary_theory : str, optional</span>
<span class="sd">            Planetary ephemerides set to be utilized in the calculations:</span>
<span class="sd">            ``&#39;INPOP&#39;``, ``&#39;DE405&#39;``, ``&#39;DE406&#39;``. Default: ``&#39;INPOP&#39;``</span>

<span class="sd">        ephtype : int, optional</span>
<span class="sd">            Type of ephemerides to be calculated: ``1``: astrometric J2000,</span>
<span class="sd">            ``2``: apparent of the date, ``3``: mean of the date,</span>
<span class="sd">            ``4``: mean J2000, Default: ``1``</span>

<span class="sd">        refplane : str, optional</span>
<span class="sd">            Reference plane: ``&#39;equator&#39;`` or ``&#39;ecliptic&#39;``. Default:</span>
<span class="sd">            ``&#39;equator&#39;``</span>

<span class="sd">        elements : str, optional</span>
<span class="sd">            Set of osculating elements to be used in the calculations:</span>
<span class="sd">            ``&#39;ASTORB&#39;`` or ``&#39;MPCORB&#39;``. Default: ``&#39;ASTORB&#39;``</span>

<span class="sd">        radial_velocity : bool, optional</span>
<span class="sd">            Calculate additional information on the target&#39;s radial velocity.</span>
<span class="sd">            Default: ``False``</span>

<span class="sd">        get_query_payload : bool, optional</span>
<span class="sd">            When set to ``True`` the method returns the HTTP request</span>
<span class="sd">            parameters as a dict, default: ``False``</span>

<span class="sd">        get_raw_response : bool, optional</span>
<span class="sd">            Return raw data as obtained by Miriade without parsing the</span>
<span class="sd">            data into a table, default: ``False``</span>

<span class="sd">        cache : bool, optional</span>
<span class="sd">            If ``True`` the query will be cached. Default: ``True``</span>


<span class="sd">        Notes</span>
<span class="sd">        -----</span>

<span class="sd">        The following parameters can be queried using this function. Note</span>
<span class="sd">        that different ``coordtype`` setting provide different sets of</span>
<span class="sd">        parameters; number in parentheses denote which ``coordtype``</span>
<span class="sd">        settings include the parameters.</span>

<span class="sd">        +------------------+-----------------------------------------------+</span>
<span class="sd">        | Column Name      | Definition                                    |</span>
<span class="sd">        +==================+===============================================+</span>
<span class="sd">        | ``target``       | Target name (str, 1, 2, 3, 4, 5, 6 )          |</span>
<span class="sd">        +------------------+-----------------------------------------------+</span>
<span class="sd">        | ``epoch``        | Ephemerides epoch (JD, float, 1, 2, 3, 4, 5,  |</span>
<span class="sd">        |                  | 6)                                            |</span>
<span class="sd">        +------------------+-----------------------------------------------+</span>
<span class="sd">        | ``RA``           | Target RA at ``ephtype`` (deg, float, 1)      |</span>
<span class="sd">        +------------------+-----------------------------------------------+</span>
<span class="sd">        | ``DEC``          | Target declination at ``ephtype`` (deg,       |</span>
<span class="sd">        |                  | float, 1, 4, 5)                               |</span>
<span class="sd">        +------------------+-----------------------------------------------+</span>
<span class="sd">        | ``RAJ2000``      | Target RA at J2000 (deg, float, 5, 6)         |</span>
<span class="sd">        +------------------+-----------------------------------------------+</span>
<span class="sd">        | ``DECJ2000``     | Target declination at J2000 (deg, float, 5, 6)|</span>
<span class="sd">        +------------------+-----------------------------------------------+</span>
<span class="sd">        | ``AZ``           | Target azimuth (deg, float, 3, 5)             |</span>
<span class="sd">        +------------------+-----------------------------------------------+</span>
<span class="sd">        | ``EL``           | Target elevation (deg, float, 3, 5)           |</span>
<span class="sd">        +------------------+-----------------------------------------------+</span>
<span class="sd">        | ``delta``        | Distance from observer (au, float, 1, 2, 3,   |</span>
<span class="sd">        |                  | 4, 5, 6)                                      |</span>
<span class="sd">        +------------------+-----------------------------------------------+</span>
<span class="sd">        | ``delta_rate``   | Rate in observer distance (km/s, float,       |</span>
<span class="sd">        |                  | 1, 5, 6)                                      |</span>
<span class="sd">        +------------------+-----------------------------------------------+</span>
<span class="sd">        | ``V``            | Apparent visual magnitude (mag, float, 1, 2,  |</span>
<span class="sd">        |                  | 3, 4, 5, 6)                                   |</span>
<span class="sd">        +------------------+-----------------------------------------------+</span>
<span class="sd">        | ``alpha``        | Solar phase angle (deg, 1, 2, 3, 4, 5, 6)     |</span>
<span class="sd">        +------------------+-----------------------------------------------+</span>
<span class="sd">        | ``elong``        | Solar elongation angle (deg, 1, 2, 3, 4, 5, 6)|</span>
<span class="sd">        +------------------+-----------------------------------------------+</span>
<span class="sd">        | ``RAcosD_rate``  | Rate of motion in RA * cos(DEC) (arcsec/min,  |</span>
<span class="sd">        |                  | float, 1, 5, 6)                               |</span>
<span class="sd">        +------------------+-----------------------------------------------+</span>
<span class="sd">        | ``DEC_rate``     | Rate of motion in DEC (arcsec/min, float, 1,  |</span>
<span class="sd">        |                  | 5, 6)                                         |</span>
<span class="sd">        +------------------+-----------------------------------------------+</span>
<span class="sd">        | ``x``            | X position state vector (au, float, 2)        |</span>
<span class="sd">        +------------------+-----------------------------------------------+</span>
<span class="sd">        | ``y``            | Y position state vector (au, float, 2)        |</span>
<span class="sd">        +------------------+-----------------------------------------------+</span>
<span class="sd">        | ``z``            | Z position state vector (au, float, 2)        |</span>
<span class="sd">        +------------------+-----------------------------------------------+</span>
<span class="sd">        | ``vx``           | X velocity state vector (au/d, float, 2)      |</span>
<span class="sd">        +------------------+-----------------------------------------------+</span>
<span class="sd">        | ``vy``           | Y velocity state vector (au/d, float, 2)      |</span>
<span class="sd">        +------------------+-----------------------------------------------+</span>
<span class="sd">        | ``vz``           | Z velocity state vector (au/d, float, 2)      |</span>
<span class="sd">        +------------------+-----------------------------------------------+</span>
<span class="sd">        | ``rv``           | Radial velocity (km/s, float, 2)              |</span>
<span class="sd">        +------------------+-----------------------------------------------+</span>
<span class="sd">        | ``heldist``      | Target heliocentric distance (au, float, 2,   |</span>
<span class="sd">        |                  | 5, 6)                                         |</span>
<span class="sd">        +------------------+-----------------------------------------------+</span>
<span class="sd">        | ``x_h``          | X heliocentric position vector (au, float, 2) |</span>
<span class="sd">        +------------------+-----------------------------------------------+</span>
<span class="sd">        | ``y_h``          | Y heliocentric position vector (au, float, 2) |</span>
<span class="sd">        +------------------+-----------------------------------------------+</span>
<span class="sd">        | ``z_h``          | Z heliocentric position vector (au, float, 2) |</span>
<span class="sd">        +------------------+-----------------------------------------------+</span>
<span class="sd">        | ``vx_h``         | X heliocentric vel. vector (au/d, float, 2)   |</span>
<span class="sd">        +------------------+-----------------------------------------------+</span>
<span class="sd">        | ``vy_h``         | Y heliocentric vel. vector (au/d, float, 2)   |</span>
<span class="sd">        +------------------+-----------------------------------------------+</span>
<span class="sd">        | ``vz_h``         | Z heliocentric vel. vector (au/d, float, 2)   |</span>
<span class="sd">        +------------------+-----------------------------------------------+</span>
<span class="sd">        | ``hourangle``    | Target hour angle (deg, float, 4, 5)          |</span>
<span class="sd">        +------------------+-----------------------------------------------+</span>
<span class="sd">        | ``siderealtime`` | Local sidereal time (hr, float, 5, 6)         |</span>
<span class="sd">        +------------------+-----------------------------------------------+</span>
<span class="sd">        | ``refraction``   | Atmospheric refraction (arcsec, float, 5, 6)  |</span>
<span class="sd">        +------------------+-----------------------------------------------+</span>
<span class="sd">        | ``airmass``      | Target airmass (float, 5, 6)                  |</span>
<span class="sd">        +------------------+-----------------------------------------------+</span>
<span class="sd">        | ``posunc``       | Positional uncertainty (arcsec, float, 5, 6)  |</span>
<span class="sd">        +------------------+-----------------------------------------------+</span>


<span class="sd">        Examples</span>
<span class="sd">        --------</span>

<span class="sd">        &gt;&gt;&gt; from astroquery.imcce import Miriade</span>
<span class="sd">        &gt;&gt;&gt; from astropy.time import Time</span>
<span class="sd">        &gt;&gt;&gt; epoch = Time(&#39;2019-01-01&#39;, format=&#39;iso&#39;)</span>
<span class="sd">        &gt;&gt;&gt; Miriade.get_ephemerides(&#39;3552&#39;, epoch=epoch)  # doctest: +SKIP</span>
<span class="sd">        &lt;Table masked=True length=1&gt;</span>
<span class="sd">           target          epoch                 RA         ...  DEC_rate   delta_rate</span>
<span class="sd">                             d                  deg         ... arcs / min    km / s</span>
<span class="sd">          bytes20         float64             float64       ...  float64     float64</span>
<span class="sd">        ----------- -------------------- ------------------ ... ---------- ------------</span>
<span class="sd">        Don Quixote            2458484.5 16.105294999999998 ...   -0.25244   31.4752734</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">URL</span> <span class="o">=</span> <span class="n">conf</span><span class="o">.</span><span class="n">ephemcc_server</span>
        <span class="n">TIMEOUT</span> <span class="o">=</span> <span class="n">conf</span><span class="o">.</span><span class="n">timeout</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">epoch</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">)):</span>
            <span class="n">epoch</span> <span class="o">=</span> <span class="n">Time</span><span class="p">(</span><span class="n">epoch</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;jd&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">epoch</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">epoch</span> <span class="o">=</span> <span class="n">Time</span><span class="p">(</span><span class="n">epoch</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;iso&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">epoch</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">epoch</span> <span class="o">=</span> <span class="n">Time</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>

        <span class="n">request_payload</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">([</span>
            <span class="p">(</span><span class="s1">&#39;-name&#39;</span><span class="p">,</span> <span class="n">targetname</span><span class="p">),</span>
            <span class="p">(</span><span class="s1">&#39;-type&#39;</span><span class="p">,</span> <span class="n">objtype</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span><span class="o">+</span><span class="n">objtype</span><span class="p">[</span><span class="mi">1</span><span class="p">:]),</span>
            <span class="p">(</span><span class="s1">&#39;-ep&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">epoch</span><span class="o">.</span><span class="n">jd</span><span class="p">)),</span>
            <span class="p">(</span><span class="s1">&#39;-step&#39;</span><span class="p">,</span> <span class="n">epoch_step</span><span class="p">),</span>
            <span class="p">(</span><span class="s1">&#39;-nbd&#39;</span><span class="p">,</span> <span class="n">epoch_nsteps</span><span class="p">),</span>
            <span class="p">(</span><span class="s1">&#39;-observer&#39;</span><span class="p">,</span> <span class="n">location</span><span class="p">),</span>
            <span class="p">(</span><span class="s1">&#39;-output&#39;</span><span class="p">,</span> <span class="s1">&#39;--jul&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s1">&#39;-tscale&#39;</span><span class="p">,</span> <span class="n">timescale</span><span class="p">),</span>
            <span class="p">(</span><span class="s1">&#39;-theory&#39;</span><span class="p">,</span> <span class="n">planetary_theory</span><span class="p">),</span>
            <span class="p">(</span><span class="s1">&#39;-teph&#39;</span><span class="p">,</span> <span class="n">ephtype</span><span class="p">),</span>
            <span class="p">(</span><span class="s1">&#39;-tcoor&#39;</span><span class="p">,</span> <span class="n">coordtype</span><span class="p">),</span>
            <span class="p">(</span><span class="s1">&#39;-rplane&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;equator&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;ecliptic&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">}[</span><span class="n">refplane</span><span class="p">]),</span>
            <span class="p">(</span><span class="s1">&#39;-oscelem&#39;</span><span class="p">,</span> <span class="n">elements</span><span class="p">),</span>
            <span class="p">(</span><span class="s1">&#39;-mime&#39;</span><span class="p">,</span> <span class="s1">&#39;votable&#39;</span><span class="p">)])</span>

        <span class="k">if</span> <span class="n">radial_velocity</span><span class="p">:</span>
            <span class="n">request_payload</span><span class="p">[</span><span class="s1">&#39;-output&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="s1">&#39;,--rv&#39;</span>

        <span class="k">if</span> <span class="n">get_query_payload</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">request_payload</span>

        <span class="c1"># query and parse</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_request</span><span class="p">(</span><span class="s1">&#39;GET&#39;</span><span class="p">,</span> <span class="n">URL</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">request_payload</span><span class="p">,</span>
                                 <span class="n">timeout</span><span class="o">=</span><span class="n">TIMEOUT</span><span class="p">,</span> <span class="n">cache</span><span class="o">=</span><span class="n">cache</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_query_uri</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">url</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_get_raw_response</span> <span class="o">=</span> <span class="n">get_raw_response</span>

        <span class="k">return</span> <span class="n">response</span></div>


    <span class="k">def</span> <span class="nf">_parse_result</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">response</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parser for Miriade request results</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">response_txt</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_raw_response</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">response_txt</span>

        <span class="c1"># intercept error messages</span>
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">response_txt</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">):</span>
            <span class="k">if</span> <span class="s1">&#39;name=&quot;QUERY_STATUS&quot; value=&quot;ERROR&quot;&#39;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
                <span class="n">errmsg</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="n">line</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;ERROR:&gt;&#39;</span><span class="p">)</span><span class="o">+</span><span class="mi">9</span><span class="p">:</span>
                              <span class="n">line</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;&lt;/vot:INFO&gt;&#39;</span><span class="p">)]</span>
                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="n">errmsg</span><span class="p">)</span>

        <span class="c1"># convert votable to table</span>
        <span class="n">commons</span><span class="o">.</span><span class="n">suppress_vo_warnings</span><span class="p">()</span>
        <span class="n">voraw</span> <span class="o">=</span> <span class="n">BytesIO</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>
        <span class="n">votable</span> <span class="o">=</span> <span class="n">parse</span><span class="p">(</span><span class="n">voraw</span><span class="p">)</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">votable</span><span class="o">.</span><span class="n">get_first_table</span><span class="p">()</span><span class="o">.</span><span class="n">to_table</span><span class="p">()</span>

        <span class="c1"># modify table columns</span>
        <span class="n">data</span><span class="p">[</span><span class="s1">&#39;epoch&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unit</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">d</span>

        <span class="k">if</span> <span class="s1">&#39;ra&#39;</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="n">data</span><span class="p">[</span><span class="s1">&#39;ra&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Angle</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;ra&#39;</span><span class="p">],</span> <span class="n">unit</span><span class="o">=</span><span class="n">u</span><span class="o">.</span><span class="n">hourangle</span><span class="p">)</span><span class="o">.</span><span class="n">deg</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">deg</span>
            <span class="n">data</span><span class="o">.</span><span class="n">rename_column</span><span class="p">(</span><span class="s1">&#39;ra&#39;</span><span class="p">,</span> <span class="s1">&#39;RA&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="s1">&#39;dec&#39;</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="n">data</span><span class="p">[</span><span class="s1">&#39;dec&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Angle</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;dec&#39;</span><span class="p">],</span> <span class="n">unit</span><span class="o">=</span><span class="n">u</span><span class="o">.</span><span class="n">deg</span><span class="p">)</span><span class="o">.</span><span class="n">deg</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">deg</span>
            <span class="n">data</span><span class="o">.</span><span class="n">rename_column</span><span class="p">(</span><span class="s1">&#39;dec&#39;</span><span class="p">,</span> <span class="s1">&#39;DEC&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="s1">&#39;raJ2000&#39;</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span> <span class="ow">and</span> <span class="s1">&#39;decJ2000&#39;</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="n">data</span><span class="p">[</span><span class="s1">&#39;raJ2000&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Angle</span><span class="p">(</span>
                <span class="n">data</span><span class="p">[</span><span class="s1">&#39;raJ2000&#39;</span><span class="p">],</span> <span class="n">unit</span><span class="o">=</span><span class="n">u</span><span class="o">.</span><span class="n">hourangle</span><span class="p">)</span><span class="o">.</span><span class="n">deg</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">deg</span>
            <span class="n">data</span><span class="p">[</span><span class="s1">&#39;decJ2000&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Angle</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;decJ2000&#39;</span><span class="p">],</span> <span class="n">unit</span><span class="o">=</span><span class="n">u</span><span class="o">.</span><span class="n">deg</span><span class="p">)</span><span class="o">.</span><span class="n">deg</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">deg</span>
            <span class="n">data</span><span class="o">.</span><span class="n">rename_column</span><span class="p">(</span><span class="s1">&#39;raJ2000&#39;</span><span class="p">,</span> <span class="s1">&#39;RAJ2000&#39;</span><span class="p">)</span>
            <span class="n">data</span><span class="o">.</span><span class="n">rename_column</span><span class="p">(</span><span class="s1">&#39;decJ2000&#39;</span><span class="p">,</span> <span class="s1">&#39;DECJ2000&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">all</span><span class="p">([</span><span class="n">p</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;xp&#39;</span><span class="p">,</span> <span class="s1">&#39;yp&#39;</span><span class="p">,</span> <span class="s1">&#39;zp&#39;</span><span class="p">]]):</span>
            <span class="n">data</span><span class="o">.</span><span class="n">rename_column</span><span class="p">(</span><span class="s1">&#39;xp&#39;</span><span class="p">,</span> <span class="s1">&#39;vx&#39;</span><span class="p">)</span>
            <span class="n">data</span><span class="o">.</span><span class="n">rename_column</span><span class="p">(</span><span class="s1">&#39;yp&#39;</span><span class="p">,</span> <span class="s1">&#39;vy&#39;</span><span class="p">)</span>
            <span class="n">data</span><span class="o">.</span><span class="n">rename_column</span><span class="p">(</span><span class="s1">&#39;zp&#39;</span><span class="p">,</span> <span class="s1">&#39;vz&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">all</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">p</span><span class="p">]</span><span class="o">.</span><span class="n">unit</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;au/day&#39;</span>
                    <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;vx&#39;</span><span class="p">,</span> <span class="s1">&#39;vy&#39;</span><span class="p">,</span> <span class="s1">&#39;vz&#39;</span><span class="p">]]):</span>
                <span class="n">data</span><span class="p">[</span><span class="s1">&#39;vx&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unit</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">au</span><span class="o">/</span><span class="n">u</span><span class="o">.</span><span class="n">day</span>
                <span class="n">data</span><span class="p">[</span><span class="s1">&#39;vy&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unit</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">au</span><span class="o">/</span><span class="n">u</span><span class="o">.</span><span class="n">day</span>
                <span class="n">data</span><span class="p">[</span><span class="s1">&#39;vz&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unit</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">au</span><span class="o">/</span><span class="n">u</span><span class="o">.</span><span class="n">day</span>

        <span class="k">if</span> <span class="nb">all</span><span class="p">([</span><span class="n">p</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;xh&#39;</span><span class="p">,</span> <span class="s1">&#39;yh&#39;</span><span class="p">,</span> <span class="s1">&#39;zh&#39;</span><span class="p">]]):</span>
            <span class="n">data</span><span class="o">.</span><span class="n">rename_column</span><span class="p">(</span><span class="s1">&#39;xh&#39;</span><span class="p">,</span> <span class="s1">&#39;x_h&#39;</span><span class="p">)</span>
            <span class="n">data</span><span class="o">.</span><span class="n">rename_column</span><span class="p">(</span><span class="s1">&#39;yh&#39;</span><span class="p">,</span> <span class="s1">&#39;y_h&#39;</span><span class="p">)</span>
            <span class="n">data</span><span class="o">.</span><span class="n">rename_column</span><span class="p">(</span><span class="s1">&#39;zh&#39;</span><span class="p">,</span> <span class="s1">&#39;z_h&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">all</span><span class="p">([</span><span class="n">p</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;xhp&#39;</span><span class="p">,</span> <span class="s1">&#39;yhp&#39;</span><span class="p">,</span> <span class="s1">&#39;zhp&#39;</span><span class="p">]]):</span>
            <span class="n">data</span><span class="o">.</span><span class="n">rename_column</span><span class="p">(</span><span class="s1">&#39;xhp&#39;</span><span class="p">,</span> <span class="s1">&#39;vx_h&#39;</span><span class="p">)</span>
            <span class="n">data</span><span class="o">.</span><span class="n">rename_column</span><span class="p">(</span><span class="s1">&#39;yhp&#39;</span><span class="p">,</span> <span class="s1">&#39;vy_h&#39;</span><span class="p">)</span>
            <span class="n">data</span><span class="o">.</span><span class="n">rename_column</span><span class="p">(</span><span class="s1">&#39;zhp&#39;</span><span class="p">,</span> <span class="s1">&#39;vz_h&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">all</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">p</span><span class="p">]</span><span class="o">.</span><span class="n">unit</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;au/day&#39;</span>
                    <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;vx_h&#39;</span><span class="p">,</span> <span class="s1">&#39;vy_h&#39;</span><span class="p">,</span> <span class="s1">&#39;vz_h&#39;</span><span class="p">]]):</span>
                <span class="n">data</span><span class="p">[</span><span class="s1">&#39;vx_h&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unit</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">au</span><span class="o">/</span><span class="n">u</span><span class="o">.</span><span class="n">day</span>
                <span class="n">data</span><span class="p">[</span><span class="s1">&#39;vy_h&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unit</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">au</span><span class="o">/</span><span class="n">u</span><span class="o">.</span><span class="n">day</span>
                <span class="n">data</span><span class="p">[</span><span class="s1">&#39;vz_h&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unit</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">au</span><span class="o">/</span><span class="n">u</span><span class="o">.</span><span class="n">day</span>

        <span class="k">if</span> <span class="s1">&#39;distance&#39;</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="n">data</span><span class="o">.</span><span class="n">rename_column</span><span class="p">(</span><span class="s1">&#39;distance&#39;</span><span class="p">,</span> <span class="s1">&#39;delta&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="s1">&#39;obsdistance&#39;</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="n">data</span><span class="o">.</span><span class="n">rename_column</span><span class="p">(</span><span class="s1">&#39;obsdistance&#39;</span><span class="p">,</span> <span class="s1">&#39;delta&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="s1">&#39;heliodistance&#39;</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="n">data</span><span class="o">.</span><span class="n">rename_column</span><span class="p">(</span><span class="s1">&#39;heliodistance&#39;</span><span class="p">,</span> <span class="s1">&#39;heldist&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="s1">&#39;azimut&#39;</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span> <span class="ow">and</span> <span class="s1">&#39;elevation&#39;</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="n">data</span><span class="p">[</span><span class="s1">&#39;azimut&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Angle</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;azimut&#39;</span><span class="p">],</span> <span class="n">unit</span><span class="o">=</span><span class="n">u</span><span class="o">.</span><span class="n">deg</span><span class="p">)</span><span class="o">.</span><span class="n">deg</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">deg</span>
            <span class="n">data</span><span class="p">[</span><span class="s1">&#39;elevation&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Angle</span><span class="p">(</span>
                <span class="n">data</span><span class="p">[</span><span class="s1">&#39;elevation&#39;</span><span class="p">],</span> <span class="n">unit</span><span class="o">=</span><span class="n">u</span><span class="o">.</span><span class="n">deg</span><span class="p">)</span><span class="o">.</span><span class="n">deg</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">deg</span>
            <span class="n">data</span><span class="o">.</span><span class="n">rename_column</span><span class="p">(</span><span class="s1">&#39;azimut&#39;</span><span class="p">,</span> <span class="s1">&#39;AZ&#39;</span><span class="p">)</span>
            <span class="n">data</span><span class="o">.</span><span class="n">rename_column</span><span class="p">(</span><span class="s1">&#39;elevation&#39;</span><span class="p">,</span> <span class="s1">&#39;EL&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="s1">&#39;mv&#39;</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="n">data</span><span class="o">.</span><span class="n">rename_column</span><span class="p">(</span><span class="s1">&#39;mv&#39;</span><span class="p">,</span> <span class="s1">&#39;V&#39;</span><span class="p">)</span>
            <span class="n">data</span><span class="p">[</span><span class="s1">&#39;V&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unit</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">mag</span>

        <span class="k">if</span> <span class="s1">&#39;phase&#39;</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="n">data</span><span class="o">.</span><span class="n">rename_column</span><span class="p">(</span><span class="s1">&#39;phase&#39;</span><span class="p">,</span> <span class="s1">&#39;alpha&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="s1">&#39;elongation&#39;</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="n">data</span><span class="o">.</span><span class="n">rename_column</span><span class="p">(</span><span class="s1">&#39;elongation&#39;</span><span class="p">,</span> <span class="s1">&#39;elong&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="s1">&#39;dracosdec&#39;</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="n">data</span><span class="o">.</span><span class="n">rename_column</span><span class="p">(</span><span class="s1">&#39;dracosdec&#39;</span><span class="p">,</span> <span class="s1">&#39;RAcosD_rate&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="s1">&#39;ddec&#39;</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="n">data</span><span class="o">.</span><span class="n">rename_column</span><span class="p">(</span><span class="s1">&#39;ddec&#39;</span><span class="p">,</span> <span class="s1">&#39;DEC_rate&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="s1">&#39;dist_dot&#39;</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="n">data</span><span class="o">.</span><span class="n">rename_column</span><span class="p">(</span><span class="s1">&#39;dist_dot&#39;</span><span class="p">,</span> <span class="s1">&#39;delta_rate&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="s1">&#39;lst&#39;</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="n">data</span><span class="o">.</span><span class="n">rename_column</span><span class="p">(</span><span class="s1">&#39;lst&#39;</span><span class="p">,</span> <span class="s1">&#39;siderealtime&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="s1">&#39;hourangle&#39;</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="n">data</span><span class="p">[</span><span class="s1">&#39;hourangle&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Angle</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;hourangle&#39;</span><span class="p">],</span>
                                      <span class="n">unit</span><span class="o">=</span><span class="n">u</span><span class="o">.</span><span class="n">hourangle</span><span class="p">)</span><span class="o">.</span><span class="n">deg</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">deg</span>

        <span class="k">if</span> <span class="s1">&#39;aeu&#39;</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="n">data</span><span class="o">.</span><span class="n">rename_column</span><span class="p">(</span><span class="s1">&#39;aeu&#39;</span><span class="p">,</span> <span class="s1">&#39;posunc&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">data</span></div>



<span class="n">Miriade</span> <span class="o">=</span> <span class="n">MiriadeClass</span><span class="p">()</span>


<div class="viewcode-block" id="SkybotClass">
<a class="viewcode-back" href="../../../api/astroquery.imcce.SkybotClass.html#astroquery.imcce.SkybotClass">[docs]</a>
<span class="nd">@async_to_sync</span>
<span class="k">class</span> <span class="nc">SkybotClass</span><span class="p">(</span><span class="n">BaseQuery</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A class for querying the `IMCCE SkyBoT</span>
<span class="sd">    &lt;https://vo.imcce.fr/webservices/skybot/&gt;`_ service.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_uri</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># query uri</span>
    <span class="n">_get_raw_response</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">uri</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        URI used in query to service.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>

<span class="sd">        &gt;&gt;&gt; from astroquery.imcce import Skybot</span>
<span class="sd">        &gt;&gt;&gt; from astropy.coordinates import SkyCoord</span>
<span class="sd">        &gt;&gt;&gt; import astropy.units as u</span>
<span class="sd">        &gt;&gt;&gt; from astropy.time import Time</span>
<span class="sd">        &gt;&gt;&gt; field = SkyCoord(1*u.deg, 1*u.deg)</span>
<span class="sd">        &gt;&gt;&gt; epoch = Time(&#39;2019-05-29 21:42&#39;, format=&#39;iso&#39;)</span>
<span class="sd">        &gt;&gt;&gt; skybot = Skybot()</span>
<span class="sd">        &gt;&gt;&gt; obj = skybot.cone_search(field, 0.1*u.deg, epoch) # doctest: +SKIP</span>
<span class="sd">        &gt;&gt;&gt; skybot.uri # doctest: +SKIP</span>
<span class="sd">        &#39;http://vo.imcce.fr/webservices/skybot/skybotconesearch_query.php?-ra=1.0&amp;-dec=1.0&amp;-rd=0.1&amp;-ep=2458633.404166667&amp;-loc=500&amp;-filter=120.0&amp;-objFilter=111&amp;-refsys=EQJ2000&amp;-output=all&amp;-mime=text&#39;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_uri</span>

<div class="viewcode-block" id="SkybotClass.cone_search_async">
<a class="viewcode-back" href="../../../api/astroquery.imcce.SkybotClass.html#astroquery.imcce.SkybotClass.cone_search_async">[docs]</a>
    <span class="k">def</span> <span class="nf">cone_search_async</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                          <span class="n">coo</span><span class="p">,</span>
                          <span class="n">rad</span><span class="p">,</span>
                          <span class="n">epoch</span><span class="p">,</span>
                          <span class="o">*</span><span class="p">,</span>
                          <span class="n">location</span><span class="o">=</span><span class="s1">&#39;500&#39;</span><span class="p">,</span>
                          <span class="n">position_error</span><span class="o">=</span><span class="mi">120</span><span class="p">,</span>
                          <span class="n">find_planets</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                          <span class="n">find_asteroids</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                          <span class="n">find_comets</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                          <span class="n">get_query_payload</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                          <span class="n">get_raw_response</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                          <span class="n">cache</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This method queries the IMCCE</span>
<span class="sd">        `SkyBoT &lt;http://vo.imcce.fr/webservices/skybot/?conesearch&gt;`_</span>
<span class="sd">        cone search service and produces a `~astropy.table.QTable` object</span>
<span class="sd">        containing all Solar System bodies that might be in the cone</span>
<span class="sd">        defined by the cone center coordinates and epoch provided.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        coo : `~astropy.coordinates.SkyCoord` object or tuple</span>
<span class="sd">            Center coordinates of the search cone in ICRS coordinates. If</span>
<span class="sd">            provided as tuple, the input is excepted as (right ascension</span>
<span class="sd">            in degrees, declination in degrees).</span>
<span class="sd">        rad : `~astropy.units.Quantity` object or float</span>
<span class="sd">            Radius of the search cone. If no units are provided (input as</span>
<span class="sd">            float), degrees are assumed. The maximum search radius is 10</span>
<span class="sd">            degrees; if this</span>
<span class="sd">            maximum radius is exceeded, it will be clipped and a warning</span>
<span class="sd">            will be provided to the user.</span>
<span class="sd">        epoch : `~astropy.time.Time` object, float, or string</span>
<span class="sd">            Epoch of search process in UT. If provided as float, it is</span>
<span class="sd">            interpreted as Julian Date, if provided as string, it is</span>
<span class="sd">            interpreted as date in the form ``&#39;YYYY-MM-DD HH-MM-SS&#39;``.</span>
<span class="sd">        location : int or str, optional</span>
<span class="sd">            Location of the observer on Earth as defined in the official</span>
<span class="sd">            `list of IAU codes</span>
<span class="sd">            &lt;https://www.minorplanetcenter.net/iau/lists/ObsCodes.html&gt;`_.</span>
<span class="sd">            Default: geocentric location (``&#39;500&#39;``)</span>
<span class="sd">        position_error : `~astropy.units.Quantity` or float, optional</span>
<span class="sd">            Maximum positional error for targets to be queried. If no</span>
<span class="sd">            unit is provided, arcseconds are assumed. Maximum positional</span>
<span class="sd">            error is 120 arcseconds, larger values are clipped and warning</span>
<span class="sd">            will be provided to the user. Default: 120 arcseconds</span>
<span class="sd">        find_planets : boolean, optional</span>
<span class="sd">            If ``True``, planets will be included in the search. Default:</span>
<span class="sd">            ``True``</span>
<span class="sd">        find_asteroids : boolean, optional</span>
<span class="sd">            If ``True``, asteroids will be included in the search. Default:</span>
<span class="sd">            ``True``</span>
<span class="sd">        find_comets : boolean, optional</span>
<span class="sd">            If ``True``, comets will be included in the search. Default:</span>
<span class="sd">            ``True``</span>
<span class="sd">        get_query_payload : boolean, optional</span>
<span class="sd">            Returns the query payload only and performs no query.</span>
<span class="sd">            Default: ``False``</span>
<span class="sd">        get_raw_response : boolean, optional</span>
<span class="sd">            Returns the raw response as provided by the IMCCE server instead</span>
<span class="sd">            of the parsed output. Default: ``False``</span>
<span class="sd">        cache : boolean, optional</span>
<span class="sd">            Cache this specfific query so it might be retrieved faster in</span>
<span class="sd">            the future. Default: ``True``</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        The following parameters are queried from the SkyBoT service:</span>

<span class="sd">        +------------------+-----------------------------------------------+</span>
<span class="sd">        | Column Name      | Definition                                    |</span>
<span class="sd">        +==================+===============================================+</span>
<span class="sd">        | ``&#39;Number&#39;``     | Target Number (``-1`` if none provided, int)  |</span>
<span class="sd">        +------------------+-----------------------------------------------+</span>
<span class="sd">        | ``&#39;Name&#39;``       | Target Name (str)                             |</span>
<span class="sd">        +------------------+-----------------------------------------------+</span>
<span class="sd">        | ``&#39;RA&#39;``         | Target RA (J2000, deg, float)                 |</span>
<span class="sd">        +------------------+-----------------------------------------------+</span>
<span class="sd">        | ``&#39;DEC&#39;``        | Target declination (J2000, deg, float)        |</span>
<span class="sd">        +------------------+-----------------------------------------------+</span>
<span class="sd">        | ``&#39;Type&#39;``       | Target dynamical/physical type (str)          |</span>
<span class="sd">        +------------------+-----------------------------------------------+</span>
<span class="sd">        | ``&#39;V&#39;``          | Target apparent brightness (V-band, mag,      |</span>
<span class="sd">        |                  | float)                                        |</span>
<span class="sd">        +------------------+-----------------------------------------------+</span>
<span class="sd">        | ``&#39;posunc&#39;``     | Positional uncertainty (arcsec, float)        |</span>
<span class="sd">        +------------------+-----------------------------------------------+</span>
<span class="sd">        | ``&#39;centerdist&#39;`` | Angular distance of target from cone center   |</span>
<span class="sd">        |                  | (arcsec, float)                               |</span>
<span class="sd">        +------------------+-----------------------------------------------+</span>
<span class="sd">        | ``&#39;RA_rate&#39;``    | RA rate of motion (arcsec/hr, float)          |</span>
<span class="sd">        +------------------+-----------------------------------------------+</span>
<span class="sd">        | ``&#39;DEC_rate&#39;``   | Declination rate of motion (arcsec/hr, float) |</span>
<span class="sd">        +------------------+-----------------------------------------------+</span>
<span class="sd">        | ``&#39;geodist&#39;``    | Geocentric distance of target (au, float)     |</span>
<span class="sd">        +------------------+-----------------------------------------------+</span>
<span class="sd">        | ``&#39;heliodist&#39;``  | Heliocentric distance of target (au, float)   |</span>
<span class="sd">        +------------------+-----------------------------------------------+</span>
<span class="sd">        | ``&#39;alpha&#39;``      | Solar phase angle (deg, float)                |</span>
<span class="sd">        +------------------+-----------------------------------------------+</span>
<span class="sd">        | ``&#39;elong&#39;``      | Solar elongation angle (deg, float)           |</span>
<span class="sd">        +------------------+-----------------------------------------------+</span>
<span class="sd">        | ``&#39;x&#39;``          | Target equatorial vector x (au, float)        |</span>
<span class="sd">        +------------------+-----------------------------------------------+</span>
<span class="sd">        | ``&#39;y&#39;``          | Target equatorial vector y (au, float)        |</span>
<span class="sd">        +------------------+-----------------------------------------------+</span>
<span class="sd">        | ``&#39;z&#39;``          | Target equatorial vector z (au, float)        |</span>
<span class="sd">        +------------------+-----------------------------------------------+</span>
<span class="sd">        | ``&#39;vx&#39;``         | Target velocity vector x (au/d, float)        |</span>
<span class="sd">        +------------------+-----------------------------------------------+</span>
<span class="sd">        | ``&#39;vy&#39;``         | Target velocity vector y (au/d, float)        |</span>
<span class="sd">        +------------------+-----------------------------------------------+</span>
<span class="sd">        | ``&#39;vz&#39;``         | Target velocity vector z (au/d, float)        |</span>
<span class="sd">        +------------------+-----------------------------------------------+</span>
<span class="sd">        | ``&#39;epoch&#39;``      | Ephemerides epoch (JD, float)                 |</span>
<span class="sd">        +------------------+-----------------------------------------------+</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; from astroquery.imcce import Skybot</span>
<span class="sd">        &gt;&gt;&gt; from astropy.coordinates import SkyCoord</span>
<span class="sd">        &gt;&gt;&gt; from astropy.time import Time</span>
<span class="sd">        &gt;&gt;&gt; import astropy.units as u</span>
<span class="sd">        &gt;&gt;&gt; field = SkyCoord(1*u.deg, 1*u.deg)</span>
<span class="sd">        &gt;&gt;&gt; epoch = Time(&#39;2019-05-29 21:42&#39;, format=&#39;iso&#39;)</span>
<span class="sd">        &gt;&gt;&gt; Skybot.cone_search(field, 0.1*u.deg, epoch)  # doctest: +SKIP</span>
<span class="sd">        &lt;QTable length=2&gt;</span>
<span class="sd">        Number    Name           RA         ...      vy          vz       epoch</span>
<span class="sd">                                deg         ...    AU / d      AU / d       d</span>
<span class="sd">        int64     str9        float64       ...   float64     float64    float64</span>
<span class="sd">        ------ --------- ------------------ ... ----------- ----------- ---------</span>
<span class="sd">        180969 2005 MM39 1.0019566666666666 ...  0.00977568 0.003022634 2458630.0</span>
<span class="sd">        107804 2001 FV58 1.0765258333333332 ... 0.006551369 0.003846177 2458630.0</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">URL</span> <span class="o">=</span> <span class="n">conf</span><span class="o">.</span><span class="n">skybot_server</span>
        <span class="n">TIMEOUT</span> <span class="o">=</span> <span class="n">conf</span><span class="o">.</span><span class="n">timeout</span>

        <span class="c1"># check for types and units</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">coo</span><span class="p">,</span> <span class="n">SkyCoord</span><span class="p">):</span>
            <span class="n">coo</span> <span class="o">=</span> <span class="n">SkyCoord</span><span class="p">(</span><span class="n">ra</span><span class="o">=</span><span class="n">coo</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">degree</span><span class="p">,</span>
                           <span class="n">dec</span><span class="o">=</span><span class="n">coo</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">degree</span><span class="p">,</span> <span class="n">frame</span><span class="o">=</span><span class="s1">&#39;icrs&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">rad</span><span class="p">,</span> <span class="n">u</span><span class="o">.</span><span class="n">Quantity</span><span class="p">):</span>
            <span class="n">rad</span> <span class="o">=</span> <span class="n">Angle</span><span class="p">(</span><span class="n">rad</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="n">rad</span><span class="o">.</span><span class="n">unit</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">rad</span><span class="p">,</span> <span class="n">u</span><span class="o">.</span><span class="n">Quantity</span><span class="p">):</span>
            <span class="n">rad</span> <span class="o">=</span> <span class="n">Angle</span><span class="p">(</span><span class="n">rad</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="n">u</span><span class="o">.</span><span class="n">degree</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">rad</span> <span class="o">&gt;</span> <span class="n">Angle</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="n">u</span><span class="o">.</span><span class="n">degree</span><span class="p">):</span>
            <span class="n">rad</span> <span class="o">=</span> <span class="n">Angle</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="n">u</span><span class="o">.</span><span class="n">degree</span><span class="p">)</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s1">&#39;search cone radius set to maximum: 10 deg&#39;</span><span class="p">,</span>
                          <span class="ne">UserWarning</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">epoch</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">)):</span>
            <span class="n">epoch</span> <span class="o">=</span> <span class="n">Time</span><span class="p">(</span><span class="n">epoch</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;jd&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">epoch</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">epoch</span> <span class="o">=</span> <span class="n">Time</span><span class="p">(</span><span class="n">epoch</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;iso&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">position_error</span><span class="p">,</span> <span class="n">u</span><span class="o">.</span><span class="n">Quantity</span><span class="p">):</span>
            <span class="n">position_error</span> <span class="o">=</span> <span class="n">Angle</span><span class="p">(</span><span class="n">position_error</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
                                   <span class="n">unit</span><span class="o">=</span><span class="n">position_error</span><span class="o">.</span><span class="n">unit</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">position_error</span><span class="p">,</span> <span class="n">u</span><span class="o">.</span><span class="n">Quantity</span><span class="p">):</span>
            <span class="n">position_error</span> <span class="o">=</span> <span class="n">Angle</span><span class="p">(</span><span class="n">position_error</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="n">u</span><span class="o">.</span><span class="n">arcsec</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">position_error</span> <span class="o">&gt;</span> <span class="n">Angle</span><span class="p">(</span><span class="mi">120</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="n">u</span><span class="o">.</span><span class="n">arcsec</span><span class="p">):</span>
            <span class="n">position_error</span> <span class="o">=</span> <span class="n">Angle</span><span class="p">(</span><span class="mi">120</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="n">u</span><span class="o">.</span><span class="n">arcsec</span><span class="p">)</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s1">&#39;positional error set to maximum: 120 arcsec&#39;</span><span class="p">,</span>
                          <span class="ne">UserWarning</span><span class="p">)</span>

        <span class="c1"># assemble payload</span>
        <span class="n">request_payload</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;-ra&#39;</span><span class="p">:</span> <span class="n">coo</span><span class="o">.</span><span class="n">ra</span><span class="o">.</span><span class="n">deg</span><span class="p">,</span>
                           <span class="s1">&#39;-dec&#39;</span><span class="p">:</span> <span class="n">coo</span><span class="o">.</span><span class="n">dec</span><span class="o">.</span><span class="n">deg</span><span class="p">,</span>
                           <span class="s1">&#39;-rd&#39;</span><span class="p">:</span> <span class="n">rad</span><span class="o">.</span><span class="n">deg</span><span class="p">,</span>
                           <span class="s1">&#39;-ep&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">epoch</span><span class="o">.</span><span class="n">jd</span><span class="p">),</span>
                           <span class="s1">&#39;-loc&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">location</span><span class="p">),</span>
                           <span class="s1">&#39;-filter&#39;</span><span class="p">:</span> <span class="n">position_error</span><span class="o">.</span><span class="n">arcsec</span><span class="p">,</span>
                           <span class="s1">&#39;-objFilter&#39;</span><span class="p">:</span>
                           <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">find_asteroids</span><span class="p">))</span>
                           <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">find_planets</span><span class="p">))</span>
                           <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">find_comets</span><span class="p">)),</span>
                           <span class="s1">&#39;-refsys&#39;</span><span class="p">:</span> <span class="s1">&#39;EQJ2000&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;-output&#39;</span><span class="p">:</span> <span class="s1">&#39;all&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;-mime&#39;</span><span class="p">:</span> <span class="s1">&#39;text&#39;</span><span class="p">}</span>

        <span class="c1"># check for diagnostic flags</span>
        <span class="k">if</span> <span class="n">get_query_payload</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">request_payload</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_get_raw_response</span> <span class="o">=</span> <span class="n">get_raw_response</span>

        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_request</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;GET&#39;</span><span class="p">,</span> <span class="n">url</span><span class="o">=</span><span class="n">URL</span><span class="p">,</span>
                                 <span class="n">params</span><span class="o">=</span><span class="n">request_payload</span><span class="p">,</span>
                                 <span class="n">timeout</span><span class="o">=</span><span class="n">TIMEOUT</span><span class="p">,</span> <span class="n">cache</span><span class="o">=</span><span class="n">cache</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_uri</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">url</span>

        <span class="k">return</span> <span class="n">response</span></div>


    <span class="k">def</span> <span class="nf">_parse_result</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">response</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        internal wrapper to parse queries</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_raw_response</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span>

        <span class="c1"># intercept error messages</span>
        <span class="n">response_txt</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)[</span><span class="mi">2</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">response_txt</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">3</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">response_txt</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;|&#39;</span><span class="p">))</span> <span class="o">&lt;</span> <span class="mi">21</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="n">response_txt</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>

        <span class="n">names</span> <span class="o">=</span> <span class="n">response_txt</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;# &#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; | &#39;</span><span class="p">)</span>
        <span class="n">results</span> <span class="o">=</span> <span class="n">ascii</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">response_txt</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;|&#39;</span><span class="p">,</span>
                             <span class="n">names</span><span class="o">=</span><span class="n">names</span><span class="p">,</span> <span class="n">fast_reader</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">results</span> <span class="o">=</span> <span class="n">QTable</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>

        <span class="c1"># convert coordinates to degrees</span>
        <span class="n">coo</span> <span class="o">=</span> <span class="n">SkyCoord</span><span class="p">(</span><span class="n">ra</span><span class="o">=</span><span class="n">results</span><span class="p">[</span><span class="s1">&#39;RA(h)&#39;</span><span class="p">],</span> <span class="n">dec</span><span class="o">=</span><span class="n">results</span><span class="p">[</span><span class="s1">&#39;DE(deg)&#39;</span><span class="p">],</span>
                       <span class="n">unit</span><span class="o">=</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">hourangle</span><span class="p">,</span> <span class="n">u</span><span class="o">.</span><span class="n">deg</span><span class="p">),</span> <span class="n">frame</span><span class="o">=</span><span class="s1">&#39;icrs&#39;</span><span class="p">)</span>
        <span class="n">results</span><span class="p">[</span><span class="s1">&#39;RA(h)&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">coo</span><span class="o">.</span><span class="n">ra</span><span class="o">.</span><span class="n">deg</span>
        <span class="n">results</span><span class="p">[</span><span class="s1">&#39;DE(deg)&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">coo</span><span class="o">.</span><span class="n">dec</span><span class="o">.</span><span class="n">deg</span>

        <span class="n">colnames</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">columns</span><span class="p">[:]</span>
        <span class="k">for</span> <span class="n">fieldname</span> <span class="ow">in</span> <span class="n">colnames</span><span class="p">:</span>
            <span class="c1"># apply field name change</span>
            <span class="n">results</span><span class="o">.</span><span class="n">rename_column</span><span class="p">(</span><span class="n">fieldname</span><span class="p">,</span> <span class="n">conf</span><span class="o">.</span><span class="n">field_names</span><span class="p">[</span><span class="n">fieldname</span><span class="p">])</span>
            <span class="c1"># apply unit, if available</span>
            <span class="k">if</span> <span class="n">conf</span><span class="o">.</span><span class="n">field_names</span><span class="p">[</span><span class="n">fieldname</span><span class="p">]</span> <span class="ow">in</span> <span class="n">conf</span><span class="o">.</span><span class="n">field_units</span><span class="p">:</span>
                <span class="n">results</span><span class="p">[</span><span class="n">conf</span><span class="o">.</span><span class="n">field_names</span><span class="p">[</span><span class="n">fieldname</span><span class="p">]]</span><span class="o">.</span><span class="n">unit</span> <span class="o">=</span> <span class="n">conf</span><span class="o">.</span><span class="n">field_units</span><span class="p">[</span>
                    <span class="n">conf</span><span class="o">.</span><span class="n">field_names</span><span class="p">[</span><span class="n">fieldname</span><span class="p">]]</span>

        <span class="c1"># convert object numbers to int</span>
        <span class="c1"># unnumbered asteroids return as non numeric values (&#39;-&#39;)</span>
        <span class="c1"># this is treated as defaulting to 0, and masking the entry</span>
        <span class="n">unnumbered_mask</span> <span class="o">=</span> <span class="p">[</span><span class="ow">not</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">isdigit</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">results</span><span class="p">[</span><span class="s1">&#39;Number&#39;</span><span class="p">]]</span>
        <span class="n">numbers</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">isdigit</span><span class="p">()</span>
                   <span class="k">else</span> <span class="mi">0</span>
                   <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">results</span><span class="p">[</span><span class="s1">&#39;Number&#39;</span><span class="p">]]</span>
        <span class="n">asteroid_number_col</span> <span class="o">=</span> <span class="n">MaskedColumn</span><span class="p">(</span><span class="n">numbers</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Number&#39;</span><span class="p">,</span>
                                           <span class="n">mask</span><span class="o">=</span><span class="n">unnumbered_mask</span><span class="p">)</span>

        <span class="n">results</span><span class="o">.</span><span class="n">replace_column</span><span class="p">(</span><span class="s1">&#39;Number&#39;</span><span class="p">,</span> <span class="n">asteroid_number_col</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">results</span></div>



<span class="n">Skybot</span> <span class="o">=</span> <span class="n">SkybotClass</span><span class="p">()</span>
</pre></div>

            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper"><h3>Page Contents</h3>


        </div>
      </div>
      <div class="clearer"></div>
    </div>
<footer class="footer">
  <p class="pull-right"> &nbsp;
    <a href="#">Back to Top</a></p>
  <p>
    &copy; Copyright 2025, The Astroquery Developers.<br/>
    Created using <a href="http://www.sphinx-doc.org/en/stable/">Sphinx</a> 7.4.7. &nbsp;
    Last built 01 Apr 2025. <br/>
  </p>
</footer>
  </body>
</html>